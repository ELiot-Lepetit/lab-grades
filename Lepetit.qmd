---
title: "Lepetit"
author: "Eliot Lepetit"
format: html
---


```{r}
#| message: false
here::i_am("lab-grades.Rproj")
library(here)
library(vroom)
library(ggplot2)
library(dplyr)
library(tidyr)

theme_set(theme_bw())
```
# Introduction

## Question 1) 
Loading the dataset
```{r}
#| message: false
grades <- vroom(here("grades.csv"))
```

# Simple analysis

## Question 2) 
The data set contains `r nrow(grades)` grades.

## Question 3) 

```{r}
num_students <- grades |> 
  distinct(id) |>
  nrow()
```

There are  `r num_students` students

## Question 4)
```{r}
students <- grades |> 
  select(id, group) |>
  distinct(id, group)
```

```{r}
students |>
  slice_tail(n = 5) |>
  knitr::kable()
```


## Question 5) 

```{r}
students_per_group <- students |> 
  group_by(group) |> 
  summarise(num_students = n())
```

```{r}
ggplot(students_per_group, aes(x = group, y = num_students)) +
  geom_col() +
  geom_text(aes(label = num_students), vjust = -0.5) +  # Adds number on top of each bar
  labs(
    title = "Number of Students per Group",
    x = "Group",
    y = "Number of Students"
  ) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Question 6) 

Filter for "Elemental Mastery and Control" and calculate the average grade per group : 
```{r}
elemental_grades <- grades |> 
  filter(course == "Elemental Mastery and Control") |> 
  group_by(group) |> 
  summarise(avg_grade = mean(grade, na.rm = TRUE))
```
 
Plot for each group
```{r}
ggplot(elemental_grades, aes(x = group, y = avg_grade)) +
  geom_col() +
  geom_text(aes(label = round(avg_grade, 1)), vjust = -0.5, size = 3) + 
  labs(
    title = "Average Grades in Elemental Mastery and Control by Group",
    x = "Group",
    y = "Average Grade",
    caption = "Note: All values have been rounded to one decimal place."
  ) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Question 7) 

```{r}
ggplot(grades, aes(x = factor(module), y = grade)) +
  geom_boxplot() +
  labs(
    title = "Grade Distribution by Module",
    x = "Module",
    y = "Grade"
  )
```
Module 1 has a slightly higher median grade. Moreover, Module 2 displays more outliers, showing that it has more extreme grades at both ends of the scale. Finally, Module 2 has the slightly shorter IQR so the middle 50% of grades are more tightly clustered around the median compared to Module 1.



